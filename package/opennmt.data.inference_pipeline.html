<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>inference_pipeline &mdash; OpenNMT-tf 2.31.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="make_cardinality_multiple_of" href="opennmt.data.make_cardinality_multiple_of.html" />
    <link rel="prev" title="get_dataset_size" href="opennmt.data.get_dataset_size.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> OpenNMT-tf
            <img src="../_static/logo-alpha.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.31
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vocabulary.html">Vocabulary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tokenization.html">Tokenization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embeddings.html">Embeddings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alignments.html">Alignments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serving.html">Serving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../v2_transition.html">2.0 Transition Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="overview.html">Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="opennmt.html">opennmt</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="opennmt.data.html">opennmt.data</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.Noise.html">Noise</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.Vocab.html">Vocab</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.WordDropout.html">WordDropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.WordNoiser.html">WordNoiser</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.WordOmission.html">WordOmission</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.WordPermutation.html">WordPermutation</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.WordReplacement.html">WordReplacement</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.alignment_matrix_from_pharaoh.html">alignment_matrix_from_pharaoh</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.batch_dataset.html">batch_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.batch_sequence_dataset.html">batch_sequence_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.create_lookup_tables.html">create_lookup_tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.filter_examples_by_length.html">filter_examples_by_length</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.filter_irregular_batches.html">filter_irregular_batches</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.get_dataset_size.html">get_dataset_size</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">inference_pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.make_cardinality_multiple_of.html">make_cardinality_multiple_of</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.random_shard.html">random_shard</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.shuffle_dataset.html">shuffle_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.tokens_to_chars.html">tokens_to_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.tokens_to_words.html">tokens_to_words</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.data.training_pipeline.html">training_pipeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.decoders.html">opennmt.decoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.encoders.html">opennmt.encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.inputters.html">opennmt.inputters</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.layers.html">opennmt.layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.models.html">opennmt.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.optimizers.html">opennmt.optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.schedules.html">opennmt.schedules</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.tokenizers.html">opennmt.tokenizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.utils.html">opennmt.utils</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenNMT-tf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="overview.html">Python</a> &raquo;</li>
          <li><a href="opennmt.data.html">opennmt.data</a> &raquo;</li>
      <li>inference_pipeline</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="inference-pipeline">
<h1>inference_pipeline<a class="headerlink" href="#inference-pipeline" title="Permalink to this headline"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="opennmt.data.inference_pipeline">
<span class="sig-prename descclassname"><span class="pre">opennmt.data.</span></span><span class="sig-name descname"><span class="pre">inference_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'examples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_fns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_bucket_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefetch_buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/data/dataset.html#inference_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#opennmt.data.inference_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Transformation that applies dataset operations for inference.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">opennmt</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">inference_pipeline</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – The batch size to use.</p></li>
<li><p><strong>batch_type</strong> – The batching strategy to use: can be “examples” or “tokens”.</p></li>
<li><p><strong>process_fn</strong> – The processing function to apply on each element.</p></li>
<li><p><strong>transform_fns</strong> – List of dataset transformation functions (applied after
<code class="xref py py-obj docutils literal notranslate"><span class="pre">process_fn</span></code> if defined).</p></li>
<li><p><strong>length_bucket_width</strong> – The width of the length buckets to select batch
candidates from. If set, this means the inference pipeline will be
reordered based on the examples length, the application is then
responsible to restore the predictions in order. An “index” key will be
inserted in the examples dictionary.</p></li>
<li><p><strong>length_fn</strong> – A function mapping features to a sequence length.</p></li>
<li><p><strong>num_threads</strong> – The number of elements processed in parallel.</p></li>
<li><p><strong>prefetch_buffer_size</strong> – The number of batches to prefetch asynchronously. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, use an automatically tuned value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">tf.data.Dataset</span></code> transformation.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – if <code class="xref py py-obj docutils literal notranslate"><span class="pre">length_bucket_width</span></code> is set but not <code class="xref py py-obj docutils literal notranslate"><span class="pre">length_fn</span></code>.</p></li>
<li><p><strong>ValueError</strong> – if <code class="xref py py-obj docutils literal notranslate"><span class="pre">length_bucket_width</span></code> is set but the dataset does not
    output a dictionary structure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="opennmt.data.get_dataset_size.html" class="btn btn-neutral float-left" title="get_dataset_size" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="opennmt.data.make_cardinality_multiple_of.html" class="btn btn-neutral float-right" title="make_cardinality_multiple_of" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>